<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>TOFU TKL é…ç½®å™¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
  <style>
    body { font-family: sans-serif; max-width: 700px; margin: 30px auto; background: #000; color: #fff; }
    label, select { display: block; margin: 12px 0; font-size: 16px; color: #fff; }
    select { background: #111; color: #fff; border: 1px solid #555; padding: 5px; }
    .result { margin-top: 20px; padding: 15px; background: #111; border: 1px solid #333; }
    .result span { color: red; font-weight: bold; }
    button { margin-top: 10px; margin-right: 10px; padding: 6px 10px; background: #222; color: #fff; border: 1px solid #444; cursor: pointer; }
    input#configLink { margin-top: 15px; width: 100%; font-size: 14px; padding: 6px; background: #222; color: #0f0; border: 1px solid #555; }
  </style>
</head>
<body>
  <h2>TOFU TKL æ¨¡æ‹Ÿå™¨</h2>

  <div>
    <button onclick="toggleLanguage()">ğŸŒ åˆ‡æ¢è¯­è¨€ / Language</button>
    <button onclick="toggleCurrency()">ğŸ’± åˆ‡æ¢è´§å¸</button>
    <button onclick="generateConfigLink()">ğŸ”— å¤åˆ¶é…ç½®é“¾æ¥</button>
  </div>

  <div id="config"></div>

  <div class="result">
    <p><strong>æ€»ä»·ï¼š</strong><span id="totalPrice">Â¥0.00</span></p>
    <p><strong>æ€»é‡é‡ï¼š</strong><span id="totalWeight">0g</span></p>
  </div>

  <input type="text" id="configLink" readonly>

  <p style="text-align: center; margin-top: 40px;">
    ğŸ‘‰ <a href="https://shimo.im/docs/m4kMMmWOezC7XBkD/" target="_blank" style="color: red; text-decoration: underline;">
      è·³è½¬åˆ° Tofu TKL è¯¦æƒ…é¡µ
    </a>
  </p>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
  <script>
    const exchangeRate = 7.15;
    const configData = {
      "top_case":[
        {"name":"é˜³æé“é»‘è‰²","name_en":"Anodized Black","price":399,"weight":379},
        {"name":"é˜³æé“é“¶è‰²","name_en":"Anodized Silver","price":399,"weight":379},
        {"name":"é˜³æé“æµ…ç°è‰²","name_en":"Anodized Light Gray","price":399,"weight":379},
        {"name":"é˜³æé“å¤§çº¢è‰²","name_en":"Anodized Red","price":399,"weight":379},
        {"name":"é˜³æé“ç°é‡‘","name_en":"Anodized Champagne Gray","price":399,"weight":379},
        {"name":"æ¶‚å±‚N9","name_en":"Coated N9","price":399,"weight":379},
        {"name":"ç”µæ³³ç™½","name_en":"E-White","price":399,"weight":379},
        {"name":"RAW","name_en":"RAW","price":399,"weight":379}
      ],
      "bottom_case":[
        {"name":"é˜³æé“é»‘è‰²","name_en":"Anodized Black","price":258.4,"weight":829},
        {"name":"é˜³æé“é“¶è‰²","name_en":"Anodized Silver","price":258.4,"weight":829},
        {"name":"é˜³æé“ç°è‰²","name_en":"Anodized Gray","price":258.4,"weight":829},
        {"name":"é˜³æé“å¤§çº¢è‰²","name_en":"Anodized Red","price":258.4,"weight":829},
        {"name":"RAW","name_en":"RAW","price":258.4,"weight":829},
        {"name":"ä¸é”ˆé’¢","name_en":"Stainless Steel","price":1700,"weight":2487},
        {"name":"çº¢é“œ","name_en":"Copper","price":955,"weight":2736},
        {"name":"é˜³æé“é»‘è‰²åˆ€çº¹","name_en":"Anodized Black Brushed","price":389,"weight":829},
        {"name":"é˜³æé“é“¶è‰²åˆ€çº¹","name_en":"Anodized Silver Brushed","price":389,"weight":829}
      ],
      "inner_plate":[
        {"name":"èƒ¡æ¡ƒæœ¨","name_en":"Walnut","price":36,"weight":3},
        {"name":"PC","name_en":"PC","price":36,"weight":12}
      ],
      "weight_block":[
        {"name":"ä¸é”ˆé’¢","name_en":"Stainless Steel","price":378,"weight":1772},
        {"name":"çº¢é“œ","name_en":"Copper","price":560,"weight":1950},
        {"name":"é“","name_en":"Aluminum","price":180,"weight":600},
        {"name":"ä¸éœ€è¦","name_en":"None","price":0,"weight":0}
      ],
      "palm_rest":[
        {"name":"é»‘è‰²","name_en":"Black","price":400,"weight":877},
        {"name":"é“¶è‰²","name_en":"Silver","price":400,"weight":877},
        {"name":"PC","name_en":"PC","price":400,"weight":550},
        {"name":"ä¸éœ€è¦","name_en":"None","price":0,"weight":0}
      ],
      "pcb":[
        {"name":"ç„Šæ¥å•æ¨¡","name_en":"Soldered (Single Mode)","price":150,"weight":100},
        {"name":"çƒ­æ’æ‹”å•æ¨¡","name_en":"Hot-swap (Single Mode)","price":150,"weight":120},
        {"name":"çƒ­æ’æ‹”åŒæ¨¡","name_en":"Hot-swap (Dual Mode)","price":270,"weight":120},
        {"name":"ç£è½´","name_en":"Magnetic Switch","price":300,"weight":110},
        {"name":"ä¸éœ€è¦","name_en":"None","price":0,"weight":0}
      ],
      "plate":[
        {"name":"ç¢³çº¤ç»´","name_en":"Carbon Fiber","price":99,"weight":41},
        {"name":"PC","name_en":"PC","price":99,"weight":41},
        {"name":"é˜³æé“","name_en":"Anodized Aluminum","price":99,"weight":81},
        {"name":"ä¸éœ€è¦","name_en":"None","price":0,"weight":0}
      ]
    };

    const container = document.getElementById('config');
    const totalPriceEl = document.getElementById('totalPrice');
    const totalWeightEl = document.getElementById('totalWeight');

    let currentLang = 'zh';
    let currentCurrency = 'CNY';

    const translations = {
      zh: {
        top_case: 'ä¸Šå£³', bottom_case: 'ä¸‹å£³', inner_plate: 'å†…ç›–æ¿',
        weight_block: 'é…é‡', palm_rest: 'æ‰‹æ‰˜', pcb: 'PCB', plate: 'å®šä½æ¿'
      },
      en: {
        top_case: 'Top Case', bottom_case: 'Bottom Case', inner_plate: 'Inner Plate',
        weight_block: 'Weight Block', palm_rest: 'Palm Rest', pcb: 'PCB', plate: 'Plate'
      }
    };

    function toggleLanguage() {
      currentLang = currentLang === 'zh' ? 'en' : 'zh';
      container.innerHTML = '';
      Object.keys(configData).forEach(key => {
        createSelect(translations[currentLang][key], key);
      });
      updateTotal();
    }

    function toggleCurrency() {
      currentCurrency = currentCurrency === 'CNY' ? 'USD' : 'CNY';
      updateTotal();
    }

    function formatPrice(price) {
      return currentCurrency === 'USD' ? '$' + (price / exchangeRate).toFixed(2) : 'Â¥' + price.toFixed(2);
    }

    function createSelect(labelText, key) {
      const label = document.createElement('label');
      label.textContent = labelText;
      const select = document.createElement('select');
      select.name = key;
      configData[key].forEach(opt => {
        const option = document.createElement('option');
        option.value = opt.name;
        option.textContent = `${currentLang === 'zh' ? opt.name : opt.name_en} - ${formatPrice(opt.price)}`;
        option.dataset.price = opt.price;
        option.dataset.weight = opt.weight;
        option.dataset.name_en = opt.name_en;
        select.appendChild(option);
      });
      select.addEventListener('change', updateTotal);
      label.appendChild(select);
      container.appendChild(label);
    }

    function updateTotal() {
      let total = 0;
      let weight = 0;
      document.querySelectorAll('select').forEach(select => {
        const selected = select.options[select.selectedIndex];
        total += parseFloat(selected.dataset.price || 0);
        weight += parseFloat(selected.dataset.weight || 0);
      });
      totalPriceEl.textContent = formatPrice(total);
      totalWeightEl.textContent = weight.toFixed(0) + 'g';
    }

    function generateConfigLink() {
      const params = new URLSearchParams();
      document.querySelectorAll('select').forEach(select => {
        params.set(select.name, select.value);
      });
      const baseUrl = location.origin + location.pathname;
      const fullUrl = baseUrl + '?' + params.toString();
      const input = document.getElementById("configLink");
      input.value = fullUrl;
      input.select();
      document.execCommand("copy");
      toastr.success("é…ç½®é“¾æ¥å·²å¤åˆ¶");
    }

    window.addEventListener("DOMContentLoaded", () => {
      const urlParams = new URLSearchParams(location.search);
      urlParams.forEach((value, key) => {
        const select = document.querySelector(`select[name="${key}"]`);
        if (select) select.value = value;
      });
      updateTotal();
    });
  </script>
</body>
</html>
